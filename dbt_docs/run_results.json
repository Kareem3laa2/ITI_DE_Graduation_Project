{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2025-08-22T23:05:26.791613Z", "invocation_id": "d46bec32-9c51-43dd-b377-d03c93d7a573", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.383057Z", "completed_at": "2025-08-22T23:05:25.418634Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.421284Z", "completed_at": "2025-08-22T23:05:25.421307Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06716465950012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.stg_nyc_properties", "compiled": true, "compiled_code": "-- models/staging/stg_nyc_properties.sql\n\n\nwith deduped as (\n    select\n        address,\n        cast(zip_code as varchar) as zip_code,\n        neighborhood,\n        block,\n        lot,\n        year_built,\n        \n        borough_name,\n        \n        tax_class_at_present,\n        cast(tax_class_at_time_of_sale as varchar) as tax_class_at_time_of_sale,\n        \n        building_class_at_present,\n        building_class_at_time_of_sale,\n        building_class_category,\n        \n        sale_date,\n        sale_price,\n        \n        residential_units,\n        try_to_number(commercial_units) as commercial_units,\n        total_units,\n        \n        land_square_feet,\n        gross_square_feet,\n        \n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(borough_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(block as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lot as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as property_key,\n        \n        row_number() over (\n            partition by\n                address,\n                borough_name,\n                block,\n                lot,\n                zip_code,\n                year_built,\n                sale_date,\n                sale_price\n            order by sale_date desc\n        ) as rn\n    from NYC_PROPERTIES.STAGING.silver_nyc_properties\n    where borough_name is not null\n      and sale_date is not null\n)\n\nselect *\nfrom deduped\nwhere rn = 1", "relation_name": "NYC_PROPERTIES.DWH_gold.stg_nyc_properties"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.396851Z", "completed_at": "2025-08-22T23:05:25.425100Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.429393Z", "completed_at": "2025-08-22T23:05:25.429408Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0757753849029541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.source_not_null_nyc_staging_silver_nyc_properties_borough_name.db9df6580a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_name\nfrom NYC_PROPERTIES.STAGING.silver_nyc_properties\nwhere borough_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.407676Z", "completed_at": "2025-08-22T23:05:25.427336Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.434354Z", "completed_at": "2025-08-22T23:05:25.434371Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08075308799743652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.source_not_null_nyc_staging_silver_nyc_properties_sale_date.7f12fa56be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom NYC_PROPERTIES.STAGING.silver_nyc_properties\nwhere sale_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.435235Z", "completed_at": "2025-08-22T23:05:25.449638Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.456397Z", "completed_at": "2025-08-22T23:05:25.456412Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.029474258422851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_borough", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_borough.sql\n\n\nselect\n    row_number() over (order by borough_name) as borough_id,\n    borough_name\nfrom (\n    select distinct \n        borough_name\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where borough_name is not null\n)\norder by borough_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_borough"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.445679Z", "completed_at": "2025-08-22T23:05:25.458918Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.463523Z", "completed_at": "2025-08-22T23:05:25.463536Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025005578994750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_building_class", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_building_class.sql\n\n\nselect\n    row_number() over (\n        order by building_class_at_time_of_sale, building_class_at_present, building_class_category\n    ) as building_class_id,\n    building_class_at_time_of_sale,\n    building_class_at_present,\n    building_class_category\nfrom (\n    select distinct\n        building_class_at_time_of_sale,\n        building_class_at_present,\n        building_class_category\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where building_class_at_time_of_sale is not null\n)\norder by building_class_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_building_class"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.451105Z", "completed_at": "2025-08-22T23:05:25.459810Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.464483Z", "completed_at": "2025-08-22T23:05:25.464495Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023047447204589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_tax_class", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_tax_class.sql\n\n\nselect\n    row_number() over (\n        order by tax_class_at_present, tax_class_at_time_of_sale\n    ) as tax_class_id,\n    tax_class_at_present,\n    tax_class_at_time_of_sale\nfrom (\n    select distinct\n        tax_class_at_present,\n        tax_class_at_time_of_sale\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where tax_class_at_present is not null\n)\norder by tax_class_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_tax_class"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.468841Z", "completed_at": "2025-08-22T23:05:25.492381Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.501374Z", "completed_at": "2025-08-22T23:05:25.501395Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04052591323852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_property", "compiled": true, "compiled_code": "\n\nwith unique_properties as (\n    select distinct\n        trim(lower(address)) as address,\n        cast(zip_code as varchar) as zip_code,\n        borough_name,\n        neighborhood,\n        block,\n        lot,\n        year_built\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where borough_name is not null\n)\n\nselect\n    row_number() over (\n        order by up.address, up.borough_name, up.block, up.lot, up.zip_code, up.year_built\n    ) as property_id,\n    up.address,\n    up.zip_code,\n    b.borough_id,\n    up.neighborhood,\n    up.block,\n    up.lot,\n    up.year_built\nfrom unique_properties up\njoin NYC_PROPERTIES.DWH_gold.dim_borough b\n    on trim(lower(up.borough_name)) = trim(lower(b.borough_name))\norder by property_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_property"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.481540Z", "completed_at": "2025-08-22T23:05:25.514348Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.518698Z", "completed_at": "2025-08-22T23:05:25.518718Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04527425765991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.accepted_values_dim_borough_borough_name__MANHATTAN__BROOKLYN__QUEENS__BRONX__STATEN_ISLAND.b696d8f209", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        borough_name as value_field,\n        count(*) as n_records\n\n    from NYC_PROPERTIES.DWH_gold.dim_borough\n    group by borough_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MANHATTAN','BROOKLYN','QUEENS','BRONX','STATEN ISLAND'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.493349Z", "completed_at": "2025-08-22T23:05:25.515261Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.519948Z", "completed_at": "2025-08-22T23:05:25.519970Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04583573341369629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_borough_borough_id.24304f5980", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_id\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.508250Z", "completed_at": "2025-08-22T23:05:25.529946Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.549504Z", "completed_at": "2025-08-22T23:05:25.549524Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04699540138244629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_borough_borough_name.267cfa4238", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_name\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.544408Z", "completed_at": "2025-08-22T23:05:25.564722Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.569225Z", "completed_at": "2025-08-22T23:05:25.569248Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.043334245681762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_at_present.21478d1f4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_at_present\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_at_present is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.534888Z", "completed_at": "2025-08-22T23:05:25.565415Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.570720Z", "completed_at": "2025-08-22T23:05:25.570741Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04690885543823242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_borough_borough_id.71317edf1a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    borough_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_id is not null\ngroup by borough_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.557716Z", "completed_at": "2025-08-22T23:05:25.577918Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.584637Z", "completed_at": "2025-08-22T23:05:25.584654Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04235410690307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_at_time_of_sale.af40da51e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_at_time_of_sale\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_at_time_of_sale is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.585834Z", "completed_at": "2025-08-22T23:05:25.608520Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.612756Z", "completed_at": "2025-08-22T23:05:25.612780Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03662848472595215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_id.09190363e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_id\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.591720Z", "completed_at": "2025-08-22T23:05:25.609419Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.614138Z", "completed_at": "2025-08-22T23:05:25.614159Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03643679618835449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_building_class_building_class_id.da7fec0cd8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    building_class_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_id is not null\ngroup by building_class_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.603009Z", "completed_at": "2025-08-22T23:05:25.619864Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.625334Z", "completed_at": "2025-08-22T23:05:25.625350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036234378814697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_at_present.64db503b57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_at_present\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_at_present is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.626609Z", "completed_at": "2025-08-22T23:05:25.649490Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.653005Z", "completed_at": "2025-08-22T23:05:25.653024Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03519034385681152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_at_time_of_sale.55afbda037", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_at_time_of_sale\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_at_time_of_sale is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.631472Z", "completed_at": "2025-08-22T23:05:25.650131Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.654345Z", "completed_at": "2025-08-22T23:05:25.654362Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0356602668762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_id.5292559145", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_id\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.643328Z", "completed_at": "2025-08-22T23:05:25.661482Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.671215Z", "completed_at": "2025-08-22T23:05:25.671234Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04388427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_tax_class_tax_class_id.0d93a96441", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    tax_class_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_id is not null\ngroup by tax_class_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.676342Z", "completed_at": "2025-08-22T23:05:25.698859Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.702390Z", "completed_at": "2025-08-22T23:05:25.702410Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.043234825134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_property_property_id.62562d0b35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect property_id\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere property_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.666100Z", "completed_at": "2025-08-22T23:05:25.699475Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.703861Z", "completed_at": "2025-08-22T23:05:25.703883Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04618692398071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_property_borough_id.006f3b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_id\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere borough_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.689755Z", "completed_at": "2025-08-22T23:05:25.710199Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.713979Z", "completed_at": "2025-08-22T23:05:25.713994Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032675743103027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_dim_property_borough_id__borough_id__ref_dim_borough_.bd89982696", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select borough_id as from_field\n    from NYC_PROPERTIES.DWH_gold.dim_property\n    where borough_id is not null\n),\n\nparent as (\n    select borough_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_borough\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.715010Z", "completed_at": "2025-08-22T23:05:25.732587Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:25.734865Z", "completed_at": "2025-08-22T23:05:25.734884Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025647640228271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_property_property_id.86802bfb5c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    property_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere property_id is not null\ngroup by property_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:25.365469Z", "completed_at": "2025-08-22T23:05:26.212971Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.214910Z", "completed_at": "2025-08-22T23:05:26.214927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1269283294677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_date", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_date.sql\n\n\nwith date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 5843\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2015-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2030-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\ndate_details as (\n    select\n        date_day as full_date,\n        to_number(to_char(date_day, 'YYYYMMDD')) as date_id,\n        extract(day from date_day) as day,\n        extract(month from date_day) as month,\n        to_char(date_day, 'MMMM') as month_name,\n        extract(month from date_day) as month_sort_order,  -- Add this for sorting\n        cast(extract(year from date_day) as int) as year,\n        extract(quarter from date_day) as quarter,             \n        case \n            when dayofweek(date_day) in (1, 7) then true \n            else false \n        end as weekend_flag\n    from date_spine\n)\n\nselect\n    date_id,\n    full_date,\n    day,\n    month,\n    month_name,\n    month_sort_order,\n    year,\n    quarter,\n    weekend_flag\nfrom date_details\norder by date_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.512472Z", "completed_at": "2025-08-22T23:05:26.528833Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.536190Z", "completed_at": "2025-08-22T23:05:26.536211Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05100202560424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_year.aac8e263ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere year is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.507206Z", "completed_at": "2025-08-22T23:05:26.529432Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.537341Z", "completed_at": "2025-08-22T23:05:26.537357Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.054682254791259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_full_date.598d7b137c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect full_date\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere full_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.500857Z", "completed_at": "2025-08-22T23:05:26.530267Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.539409Z", "completed_at": "2025-08-22T23:05:26.539425Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.058588504791259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_date_id.3077875806", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_id\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere date_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.494941Z", "completed_at": "2025-08-22T23:05:26.533484Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.544208Z", "completed_at": "2025-08-22T23:05:26.544223Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06502652168273926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.accepted_values_dim_date_year__2015__2016__2017__2018__2019__2020__2021__2022__2023__2024__2025__2026__2027__2028__2029__2030.d832069a06", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        year as value_field,\n        count(*) as n_records\n\n    from NYC_PROPERTIES.DWH_gold.dim_date\n    group by year\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025','2026','2027','2028','2029','2030'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.563005Z", "completed_at": "2025-08-22T23:05:26.573455Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.575918Z", "completed_at": "2025-08-22T23:05:26.575938Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.023207426071166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.fact_sales", "compiled": true, "compiled_code": "-- models/marts/facts/fact_sales.sql\n\n\nwith joined_sales as (\n    select\n        d.date_id as sale_date_id,\n        p.property_id,\n        bc.building_class_id,\n        tc.tax_class_id,\n        s.sale_price,\n        s.residential_units,\n        s.commercial_units,\n        s.total_units,\n        s.land_square_feet,\n        s.gross_square_feet,\n        row_number() over (\n            partition by \n                d.date_id,\n                p.property_id,\n                bc.building_class_id,\n                tc.tax_class_id,\n                s.sale_price\n            order by s.sale_date desc\n        ) as rn\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties s\n    join NYC_PROPERTIES.DWH_gold.dim_date d\n        on cast(s.sale_date as date) = d.full_date\n    join NYC_PROPERTIES.DWH_gold.dim_property p\n        on trim(lower(s.address)) = trim(lower(p.address))\n       and s.zip_code = p.zip_code\n    join NYC_PROPERTIES.DWH_gold.dim_building_class bc\n        on s.building_class_at_time_of_sale = bc.building_class_at_time_of_sale\n       and s.building_class_at_present = bc.building_class_at_present\n       and s.building_class_category = bc.building_class_category\n    join NYC_PROPERTIES.DWH_gold.dim_tax_class tc\n        on s.tax_class_at_time_of_sale = tc.tax_class_at_time_of_sale\n       and s.tax_class_at_present = tc.tax_class_at_present\n    where s.sale_date is not null\n      and s.borough_name is not null\n)\n\nselect\n    row_number() over (order by sale_date_id, property_id, building_class_id, tax_class_id, sale_price) as fact_id,\n    sale_date_id,\n    property_id,\n    building_class_id,\n    tax_class_id,\n    sale_price,\n    residential_units,\n    commercial_units,\n    total_units,\n    land_square_feet,\n    gross_square_feet\nfrom joined_sales\nwhere rn = 1\norder by fact_id", "relation_name": "NYC_PROPERTIES.DWH_gold.fact_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.558045Z", "completed_at": "2025-08-22T23:05:26.582020Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.602585Z", "completed_at": "2025-08-22T23:05:26.602601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06104135513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_date_date_id.7286dcb90d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere date_id is not null\ngroup by date_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.608523Z", "completed_at": "2025-08-22T23:05:26.626239Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.631864Z", "completed_at": "2025-08-22T23:05:26.631882Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05110645294189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_fact_id.5908042167", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fact_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere fact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.590587Z", "completed_at": "2025-08-22T23:05:26.626812Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.632982Z", "completed_at": "2025-08-22T23:05:26.632996Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05602741241455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.dbt_utils_unique_combination_of_columns_fact_sales_sale_date_id__property_id__building_class_id__tax_class_id__sale_price.23a239cdc2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        sale_date_id, property_id, building_class_id, tax_class_id, sale_price\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    group by sale_date_id, property_id, building_class_id, tax_class_id, sale_price\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.603803Z", "completed_at": "2025-08-22T23:05:26.627277Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.634197Z", "completed_at": "2025-08-22T23:05:26.634209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.055411577224731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_building_class_id.51b191dd7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere building_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.619414Z", "completed_at": "2025-08-22T23:05:26.639090Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.649546Z", "completed_at": "2025-08-22T23:05:26.649561Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0363154411315918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_land_square_feet.021b563173", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect land_square_feet\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere land_square_feet is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.654633Z", "completed_at": "2025-08-22T23:05:26.683149Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.689442Z", "completed_at": "2025-08-22T23:05:26.689467Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04826641082763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_property_id.ef4fdd46f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect property_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere property_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.664534Z", "completed_at": "2025-08-22T23:05:26.683857Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.690646Z", "completed_at": "2025-08-22T23:05:26.690661Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0469670295715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_sale_price.6ee649a558", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_price\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere sale_price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.659403Z", "completed_at": "2025-08-22T23:05:26.684428Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.692011Z", "completed_at": "2025-08-22T23:05:26.692023Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05074715614318848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_sale_date_id.90ceb11a0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere sale_date_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.675185Z", "completed_at": "2025-08-22T23:05:26.691312Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.700641Z", "completed_at": "2025-08-22T23:05:26.700654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03243899345397949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_tax_class_id.145400d866", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere tax_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.723706Z", "completed_at": "2025-08-22T23:05:26.740068Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.746241Z", "completed_at": "2025-08-22T23:05:26.746268Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04451704025268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_sale_date_id__date_id__ref_dim_date_.5d6b1dc8a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select sale_date_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where sale_date_id is not null\n),\n\nparent as (\n    select date_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_date\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.716938Z", "completed_at": "2025-08-22T23:05:26.740834Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.747732Z", "completed_at": "2025-08-22T23:05:26.747751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.048867225646972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_property_id__property_id__ref_dim_property_.061b794318", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select property_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where property_id is not null\n),\n\nparent as (\n    select property_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_property\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.711156Z", "completed_at": "2025-08-22T23:05:26.741409Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.748970Z", "completed_at": "2025-08-22T23:05:26.748986Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05193924903869629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_building_class_id__building_class_id__ref_dim_building_class_.9720beb36a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select building_class_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where building_class_id is not null\n),\n\nparent as (\n    select building_class_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_building_class\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.732317Z", "completed_at": "2025-08-22T23:05:26.749567Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.759631Z", "completed_at": "2025-08-22T23:05:26.759647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0400540828704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_tax_class_id__tax_class_id__ref_dim_tax_class_.577fa7bb19", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select tax_class_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where tax_class_id is not null\n),\n\nparent as (\n    select tax_class_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_tax_class\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:05:26.765145Z", "completed_at": "2025-08-22T23:05:26.781630Z"}, {"name": "execute", "started_at": "2025-08-22T23:05:26.783895Z", "completed_at": "2025-08-22T23:05:26.783913Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024303436279296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_fact_sales_fact_id.3a5386c053", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    fact_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere fact_id is not null\ngroup by fact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 4.555267333984375, "args": {"show_resource_report": false, "compile": true, "log_level_file": "debug", "empty_catalog": false, "profiles_dir": "/root/.dbt", "partial_parse_file_diff": true, "which": "generate", "use_colors": true, "enable_legacy_logger": false, "static_parser": true, "log_path": "/usr/app/NYC_Properties_DBT/logs", "log_level": "info", "indirect_selection": "eager", "partial_parse": true, "strict_mode": false, "send_anonymous_usage_stats": true, "log_format": "default", "favor_state": false, "cache_selected_only": false, "introspect": true, "log_file_max_bytes": 10485760, "exclude": [], "printer_width": 80, "log_format_file": "debug", "select": [], "macro_debugging": false, "use_colors_file": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "populate_cache": true, "project_dir": "/usr/app/NYC_Properties_DBT", "invocation_command": "dbt docs generate", "quiet": false, "defer": false, "print": true, "static": false, "write_json": true}}