{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2025-08-22T23:11:45.319045Z", "invocation_id": "e2bf7f4f-7936-4a00-8403-1917887e8fc5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.024286Z", "completed_at": "2025-08-22T23:11:44.034669Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.040229Z", "completed_at": "2025-08-22T23:11:44.040247Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06052708625793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.source_not_null_nyc_staging_silver_nyc_properties_sale_date.7f12fa56be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom NYC_PROPERTIES.STAGING.silver_nyc_properties\nwhere sale_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.002386Z", "completed_at": "2025-08-22T23:11:44.035416Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.042162Z", "completed_at": "2025-08-22T23:11:44.042172Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06550025939941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.stg_nyc_properties", "compiled": true, "compiled_code": "-- models/staging/stg_nyc_properties.sql\n\n\nwith deduped as (\n    select\n        address,\n        cast(zip_code as varchar) as zip_code,\n        neighborhood,\n        block,\n        lot,\n        year_built,\n        \n        borough_name,\n        \n        tax_class_at_present,\n        cast(tax_class_at_time_of_sale as varchar) as tax_class_at_time_of_sale,\n        \n        building_class_at_present,\n        building_class_at_time_of_sale,\n        building_class_category,\n        \n        sale_date,\n        sale_price,\n        \n        residential_units,\n        try_to_number(commercial_units) as commercial_units,\n        total_units,\n        \n        land_square_feet,\n        gross_square_feet,\n        \n        md5(cast(coalesce(cast(address as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(borough_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(block as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lot as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as property_key,\n        \n        row_number() over (\n            partition by\n                address,\n                borough_name,\n                block,\n                lot,\n                zip_code,\n                year_built,\n                sale_date,\n                sale_price\n            order by sale_date desc\n        ) as rn\n    from NYC_PROPERTIES.STAGING.silver_nyc_properties\n    where borough_name is not null\n      and sale_date is not null\n)\n\nselect *\nfrom deduped\nwhere rn = 1", "relation_name": "NYC_PROPERTIES.DWH_gold.stg_nyc_properties"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.014293Z", "completed_at": "2025-08-22T23:11:44.038149Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.044189Z", "completed_at": "2025-08-22T23:11:44.044199Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06619596481323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.source_not_null_nyc_staging_silver_nyc_properties_borough_name.db9df6580a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_name\nfrom NYC_PROPERTIES.STAGING.silver_nyc_properties\nwhere borough_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.056052Z", "completed_at": "2025-08-22T23:11:44.073727Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.077954Z", "completed_at": "2025-08-22T23:11:44.077968Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030368804931640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_borough", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_borough.sql\n\n\nselect\n    row_number() over (order by borough_name) as borough_id,\n    borough_name\nfrom (\n    select distinct \n        borough_name\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where borough_name is not null\n)\norder by borough_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_borough"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.060309Z", "completed_at": "2025-08-22T23:11:44.075179Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.079603Z", "completed_at": "2025-08-22T23:11:44.079614Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031183481216430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_building_class", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_building_class.sql\n\n\nselect\n    row_number() over (\n        order by building_class_at_time_of_sale, building_class_at_present, building_class_category\n    ) as building_class_id,\n    building_class_at_time_of_sale,\n    building_class_at_present,\n    building_class_category\nfrom (\n    select distinct\n        building_class_at_time_of_sale,\n        building_class_at_present,\n        building_class_category\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where building_class_at_time_of_sale is not null\n)\norder by building_class_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_building_class"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.064105Z", "completed_at": "2025-08-22T23:11:44.076515Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.081498Z", "completed_at": "2025-08-22T23:11:44.081506Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.032361507415771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_tax_class", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_tax_class.sql\n\n\nselect\n    row_number() over (\n        order by tax_class_at_present, tax_class_at_time_of_sale\n    ) as tax_class_id,\n    tax_class_at_present,\n    tax_class_at_time_of_sale\nfrom (\n    select distinct\n        tax_class_at_present,\n        tax_class_at_time_of_sale\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where tax_class_at_present is not null\n)\norder by tax_class_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_tax_class"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.091930Z", "completed_at": "2025-08-22T23:11:44.112305Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.118095Z", "completed_at": "2025-08-22T23:11:44.118110Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.034241676330566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_property", "compiled": true, "compiled_code": "\n\nwith unique_properties as (\n    select distinct\n        trim(lower(address)) as address,\n        cast(zip_code as varchar) as zip_code,\n        borough_name,\n        neighborhood,\n        block,\n        lot,\n        year_built\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties\n    where borough_name is not null\n)\n\nselect\n    row_number() over (\n        order by up.address, up.borough_name, up.block, up.lot, up.zip_code, up.year_built\n    ) as property_id,\n    up.address,\n    up.zip_code,\n    b.borough_id,\n    up.neighborhood,\n    up.block,\n    up.lot,\n    up.year_built\nfrom unique_properties up\njoin NYC_PROPERTIES.DWH_gold.dim_borough b\n    on trim(lower(up.borough_name)) = trim(lower(b.borough_name))\norder by property_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_property"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.105462Z", "completed_at": "2025-08-22T23:11:44.113560Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.119676Z", "completed_at": "2025-08-22T23:11:44.119689Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03271365165710449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_borough_borough_id.24304f5980", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_id\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.096042Z", "completed_at": "2025-08-22T23:11:44.115866Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.121723Z", "completed_at": "2025-08-22T23:11:44.121732Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03643989562988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.accepted_values_dim_borough_borough_name__MANHATTAN__BROOKLYN__QUEENS__BRONX__STATEN_ISLAND.b696d8f209", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        borough_name as value_field,\n        count(*) as n_records\n\n    from NYC_PROPERTIES.DWH_gold.dim_borough\n    group by borough_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MANHATTAN','BROOKLYN','QUEENS','BRONX','STATEN ISLAND'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.131363Z", "completed_at": "2025-08-22T23:11:44.149070Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.155568Z", "completed_at": "2025-08-22T23:11:44.155591Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03380131721496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_borough_borough_name.267cfa4238", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_name\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.136256Z", "completed_at": "2025-08-22T23:11:44.150965Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.158679Z", "completed_at": "2025-08-22T23:11:44.158695Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03491783142089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_borough_borough_id.71317edf1a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    borough_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_borough\nwhere borough_id is not null\ngroup by borough_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.142257Z", "completed_at": "2025-08-22T23:11:44.152710Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.161595Z", "completed_at": "2025-08-22T23:11:44.161607Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03549838066101074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_at_present.21478d1f4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_at_present\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_at_present is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.175796Z", "completed_at": "2025-08-22T23:11:44.207044Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.216046Z", "completed_at": "2025-08-22T23:11:44.216076Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05392718315124512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_at_time_of_sale.af40da51e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_at_time_of_sale\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_at_time_of_sale is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.189245Z", "completed_at": "2025-08-22T23:11:44.208529Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.219785Z", "completed_at": "2025-08-22T23:11:44.219808Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.051726341247558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_building_class_building_class_id.da7fec0cd8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    building_class_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_id is not null\ngroup by building_class_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.182839Z", "completed_at": "2025-08-22T23:11:44.210584Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.222895Z", "completed_at": "2025-08-22T23:11:44.222910Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05795645713806152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_building_class_building_class_id.09190363e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_id\nfrom NYC_PROPERTIES.DWH_gold.dim_building_class\nwhere building_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.240616Z", "completed_at": "2025-08-22T23:11:44.283979Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.288076Z", "completed_at": "2025-08-22T23:11:44.288095Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05922865867614746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_at_present.64db503b57", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_at_present\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_at_present is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.253286Z", "completed_at": "2025-08-22T23:11:44.287175Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.292890Z", "completed_at": "2025-08-22T23:11:44.292906Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07449221611022949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_at_time_of_sale.55afbda037", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_at_time_of_sale\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_at_time_of_sale is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.267605Z", "completed_at": "2025-08-22T23:11:44.289937Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.310921Z", "completed_at": "2025-08-22T23:11:44.310938Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08137941360473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_tax_class_tax_class_id.5292559145", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_id\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.326947Z", "completed_at": "2025-08-22T23:11:44.351938Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.356200Z", "completed_at": "2025-08-22T23:11:44.356215Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04653286933898926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_tax_class_tax_class_id.0d93a96441", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    tax_class_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_tax_class\nwhere tax_class_id is not null\ngroup by tax_class_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.339854Z", "completed_at": "2025-08-22T23:11:44.352829Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.357010Z", "completed_at": "2025-08-22T23:11:44.357020Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03843402862548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_property_borough_id.006f3b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect borough_id\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere borough_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.346959Z", "completed_at": "2025-08-22T23:11:44.355448Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.361739Z", "completed_at": "2025-08-22T23:11:44.361750Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030133485794067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_property_property_id.62562d0b35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect property_id\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere property_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.373122Z", "completed_at": "2025-08-22T23:11:44.388565Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.390979Z", "completed_at": "2025-08-22T23:11:44.390994Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02570319175720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_dim_property_borough_id__borough_id__ref_dim_borough_.bd89982696", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select borough_id as from_field\n    from NYC_PROPERTIES.DWH_gold.dim_property\n    where borough_id is not null\n),\n\nparent as (\n    select borough_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_borough\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.380887Z", "completed_at": "2025-08-22T23:11:44.390211Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.393922Z", "completed_at": "2025-08-22T23:11:44.393931Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027029752731323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_property_property_id.86802bfb5c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    property_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_property\nwhere property_id is not null\ngroup by property_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:43.987758Z", "completed_at": "2025-08-22T23:11:44.673195Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:44.675620Z", "completed_at": "2025-08-22T23:11:44.675645Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9816756248474121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.dim_date", "compiled": true, "compiled_code": "-- models/marts/dimensions/dim_date.sql\n\n\nwith date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n     + \n    \n    p12.generated_number * power(2, 12)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n     cross join \n    \n    p as p12\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 5843\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2015-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2030-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\ndate_details as (\n    select\n        date_day as full_date,\n        to_number(to_char(date_day, 'YYYYMMDD')) as date_id,\n        extract(day from date_day) as day,\n        extract(month from date_day) as month,\n        to_char(date_day, 'MMMM') as month_name,\n        extract(month from date_day) as month_sort_order,  -- Add this for sorting\n        cast(extract(year from date_day) as int) as year,\n        extract(quarter from date_day) as quarter,             \n        case \n            when dayofweek(date_day) in (1, 7) then true \n            else false \n        end as weekend_flag\n    from date_spine\n)\n\nselect\n    date_id,\n    full_date,\n    day,\n    month,\n    month_name,\n    month_sort_order,\n    year,\n    quarter,\n    weekend_flag\nfrom date_details\norder by date_id", "relation_name": "NYC_PROPERTIES.DWH_gold.dim_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.988845Z", "completed_at": "2025-08-22T23:11:45.003197Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.008580Z", "completed_at": "2025-08-22T23:11:45.008596Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04470491409301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_full_date.598d7b137c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect full_date\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere full_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.976234Z", "completed_at": "2025-08-22T23:11:45.004487Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.011809Z", "completed_at": "2025-08-22T23:11:45.011821Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05251932144165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.accepted_values_dim_date_year__2015__2016__2017__2018__2019__2020__2021__2022__2023__2024__2025__2026__2027__2028__2029__2030.d832069a06", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        year as value_field,\n        count(*) as n_records\n\n    from NYC_PROPERTIES.DWH_gold.dim_date\n    group by year\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025','2026','2027','2028','2029','2030'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.982161Z", "completed_at": "2025-08-22T23:11:45.006401Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.014432Z", "completed_at": "2025-08-22T23:11:45.014455Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05361485481262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_date_id.3077875806", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_id\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere date_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:44.993796Z", "completed_at": "2025-08-22T23:11:45.006924Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.015717Z", "completed_at": "2025-08-22T23:11:45.015730Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05222439765930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_dim_date_year.aac8e263ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect year\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere year is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.037493Z", "completed_at": "2025-08-22T23:11:45.048607Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.053110Z", "completed_at": "2025-08-22T23:11:45.053129Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02757096290588379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nyc_properties.fact_sales", "compiled": true, "compiled_code": "-- models/marts/facts/fact_sales.sql\n\n\nwith joined_sales as (\n    select\n        d.date_id as sale_date_id,\n        p.property_id,\n        bc.building_class_id,\n        tc.tax_class_id,\n        s.sale_price,\n        s.residential_units,\n        s.commercial_units,\n        s.total_units,\n        s.land_square_feet,\n        s.gross_square_feet,\n        row_number() over (\n            partition by \n                d.date_id,\n                p.property_id,\n                bc.building_class_id,\n                tc.tax_class_id,\n                s.sale_price\n            order by s.sale_date desc\n        ) as rn\n    from NYC_PROPERTIES.DWH_gold.stg_nyc_properties s\n    join NYC_PROPERTIES.DWH_gold.dim_date d\n        on cast(s.sale_date as date) = d.full_date\n    join NYC_PROPERTIES.DWH_gold.dim_property p\n        on trim(lower(s.address)) = trim(lower(p.address))\n       and s.zip_code = p.zip_code\n    join NYC_PROPERTIES.DWH_gold.dim_building_class bc\n        on s.building_class_at_time_of_sale = bc.building_class_at_time_of_sale\n       and s.building_class_at_present = bc.building_class_at_present\n       and s.building_class_category = bc.building_class_category\n    join NYC_PROPERTIES.DWH_gold.dim_tax_class tc\n        on s.tax_class_at_time_of_sale = tc.tax_class_at_time_of_sale\n       and s.tax_class_at_present = tc.tax_class_at_present\n    where s.sale_date is not null\n      and s.borough_name is not null\n)\n\nselect\n    row_number() over (order by sale_date_id, property_id, building_class_id, tax_class_id, sale_price) as fact_id,\n    sale_date_id,\n    property_id,\n    building_class_id,\n    tax_class_id,\n    sale_price,\n    residential_units,\n    commercial_units,\n    total_units,\n    land_square_feet,\n    gross_square_feet\nfrom joined_sales\nwhere rn = 1\norder by fact_id", "relation_name": "NYC_PROPERTIES.DWH_gold.fact_sales"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.031652Z", "completed_at": "2025-08-22T23:11:45.049290Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.054100Z", "completed_at": "2025-08-22T23:11:45.054111Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03236055374145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_dim_date_date_id.7286dcb90d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.dim_date\nwhere date_id is not null\ngroup by date_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.083076Z", "completed_at": "2025-08-22T23:11:45.103284Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.108463Z", "completed_at": "2025-08-22T23:11:45.108491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05129694938659668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_building_class_id.51b191dd7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect building_class_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere building_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.087976Z", "completed_at": "2025-08-22T23:11:45.104438Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.112268Z", "completed_at": "2025-08-22T23:11:45.112282Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.053167104721069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_fact_id.5908042167", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fact_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere fact_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.092857Z", "completed_at": "2025-08-22T23:11:45.105951Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.114914Z", "completed_at": "2025-08-22T23:11:45.114926Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05435633659362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_land_square_feet.021b563173", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect land_square_feet\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere land_square_feet is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.070554Z", "completed_at": "2025-08-22T23:11:45.106507Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.115900Z", "completed_at": "2025-08-22T23:11:45.115911Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.059926748275756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.dbt_utils_unique_combination_of_columns_fact_sales_sale_date_id__property_id__building_class_id__tax_class_id__sale_price.23a239cdc2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        sale_date_id, property_id, building_class_id, tax_class_id, sale_price\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    group by sale_date_id, property_id, building_class_id, tax_class_id, sale_price\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.133877Z", "completed_at": "2025-08-22T23:11:45.216903Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.220132Z", "completed_at": "2025-08-22T23:11:45.220158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09818124771118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_property_id.ef4fdd46f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect property_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere property_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.141082Z", "completed_at": "2025-08-22T23:11:45.222761Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.230161Z", "completed_at": "2025-08-22T23:11:45.230175Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10758042335510254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_sale_date_id.90ceb11a0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere sale_date_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.147535Z", "completed_at": "2025-08-22T23:11:45.224343Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.232258Z", "completed_at": "2025-08-22T23:11:45.232275Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11464905738830566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_sale_price.6ee649a558", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_price\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere sale_price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.153375Z", "completed_at": "2025-08-22T23:11:45.224879Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.233499Z", "completed_at": "2025-08-22T23:11:45.233522Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11529684066772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.not_null_fact_sales_tax_class_id.145400d866", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tax_class_id\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere tax_class_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.236926Z", "completed_at": "2025-08-22T23:11:45.255856Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.279440Z", "completed_at": "2025-08-22T23:11:45.279458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05598568916320801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_building_class_id__building_class_id__ref_dim_building_class_.9720beb36a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select building_class_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where building_class_id is not null\n),\n\nparent as (\n    select building_class_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_building_class\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.273336Z", "completed_at": "2025-08-22T23:11:45.287467Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.298685Z", "completed_at": "2025-08-22T23:11:45.298709Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0475006103515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_tax_class_id__tax_class_id__ref_dim_tax_class_.577fa7bb19", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select tax_class_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where tax_class_id is not null\n),\n\nparent as (\n    select tax_class_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_tax_class\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.267592Z", "completed_at": "2025-08-22T23:11:45.292833Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.300042Z", "completed_at": "2025-08-22T23:11:45.300058Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05134248733520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_sale_date_id__date_id__ref_dim_date_.5d6b1dc8a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select sale_date_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where sale_date_id is not null\n),\n\nparent as (\n    select date_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_date\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.261685Z", "completed_at": "2025-08-22T23:11:45.293287Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.301028Z", "completed_at": "2025-08-22T23:11:45.301042Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.054103851318359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.relationships_fact_sales_property_id__property_id__ref_dim_property_.061b794318", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select property_id as from_field\n    from NYC_PROPERTIES.DWH_gold.fact_sales\n    where property_id is not null\n),\n\nparent as (\n    select property_id as to_field\n    from NYC_PROPERTIES.DWH_gold.dim_property\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T23:11:45.288095Z", "completed_at": "2025-08-22T23:11:45.303445Z"}, {"name": "execute", "started_at": "2025-08-22T23:11:45.310951Z", "completed_at": "2025-08-22T23:11:45.310969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027619123458862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nyc_properties.unique_fact_sales_fact_id.3a5386c053", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    fact_id as unique_field,\n    count(*) as n_records\n\nfrom NYC_PROPERTIES.DWH_gold.fact_sales\nwhere fact_id is not null\ngroup by fact_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.5205039978027344, "args": {"introspect": true, "log_level": "info", "print": true, "use_colors_file": true, "invocation_command": "dbt docs generate", "printer_width": 80, "cache_selected_only": false, "macro_debugging": false, "use_colors": true, "profiles_dir": "/root/.dbt", "strict_mode": false, "exclude": [], "write_json": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "quiet": false, "partial_parse": true, "defer": false, "enable_legacy_logger": false, "log_level_file": "debug", "show_resource_report": false, "version_check": true, "project_dir": "/usr/app/NYC_Properties_DBT", "indirect_selection": "eager", "static_parser": true, "empty_catalog": false, "static": false, "log_format": "default", "which": "generate", "partial_parse_file_diff": true, "select": [], "populate_cache": true, "favor_state": false, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "compile": true, "log_path": "/usr/app/NYC_Properties_DBT/logs"}}